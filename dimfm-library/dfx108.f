      SUBROUTINE DFX108(YEND)
      LOGICAL LF,LT
      LOGICAL DFX103
      INCLUDE 'dfxc00.cmn'
      INCLUDE 'dfxc00s.cmn'
      DATA LT,LF/.TRUE.,.FALSE./
      Y2 = YEND
      Y1 = YPOS
      IF (Y2.LT.Y1) GO TO 10
      ASSIGN 1 TO I
      IF (.NOT.BLNKS.OR..NOT.DFX103(XPOS,XBB1,XBB2)) ASSIGN 3 TO I
      IF (Y1.GE.YTB1) GO TO I,(1,3)
      Y1 = AMIN1(Y2,YTB1)
      CALL DFX104(LF,XPOS,Y1)
      IF (Y2.EQ.Y1) GO TO 20
      GO TO I,(1,3)
    1 IF (Y1.GE.YBB1) GO TO 2
      Y1 = AMIN1(Y2,YBB1)
      CALL DFX104(LT,XPOS,Y1)
      IF (Y2.EQ.Y1) GO TO 20
    2 IF (Y1.GE.YBB2) GO TO 3
      Y1 = AMIN1(Y2,YBB2)
      CALL DFX104(LF,XPOS,Y1)
      IF (Y2.EQ.Y1) GO TO 20
    3 IF (Y1.GE.YTB2) GO TO 4
      Y1 = AMIN1(Y2,YTB2)
      CALL DFX104(LT,XPOS,Y1)
      IF (Y2.EQ.Y1) GO TO 20
      GO TO 4
   10 ASSIGN 11 TO I
      IF (.NOT.BLNKS.OR..NOT.DFX103(XPOS,XBB1,XBB2)) ASSIGN 13 TO I
      IF (Y1.LE.YTB2) GO TO I,(11,13)
      Y1 = AMAX1(Y2,YTB2)
      CALL DFX104(LF,XPOS,Y1)
      IF (Y2.EQ.Y1) GO TO 20
      GO TO I,(11,13)
   11 IF (Y1.LE.YBB2) GO TO 12
      Y1 = AMAX1(Y2,YBB2)
      CALL DFX104(LT,XPOS,Y1)
      IF (Y2.EQ.Y1) GO TO 20
   12 IF (Y1.LE.YBB1) GO TO 13
      Y1 = AMAX1(Y2,YBB1)
      CALL DFX104(LF,XPOS,Y1)
      IF (Y2.EQ.Y1) GO TO 20
   13 IF (Y1.LE.YTB1) GO TO 4
      Y1 = AMAX1(Y2,YTB1)
      CALL DFX104(LT,XPOS,Y1)
      IF (Y2.EQ.Y1) GO TO 20
    4 CALL DFX104(LF,XPOS,Y2)
   20 YPOS = Y2
      RETURN
      END
C
C----------------------------------------------
C
